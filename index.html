<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Code Master</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    .title-section h1 {
      font-weight: bold;
      background: linear-gradient(90deg, #ff416c, #ff4b2b, #ff9933);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      font-size: 2.5rem;
    }

    .title-section h6 {
      color: #6c757d;
      letter-spacing: 1px;
      font-style: italic;
    }

    .fade-card {
      transition: opacity 0.4s ease, transform 0.4s ease;
    }

    .hidden {
      opacity: 0;
      transform: scale(0.98);
      pointer-events: none;
      position: absolute;
    }

    .visible {
      opacity: 1;
      transform: scale(1);
      pointer-events: auto;
      position: relative;
    }

    #topMessage {
      position: fixed;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 999;
      font-size: 0.9rem;
    }

    .toast-container {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 1055;
    }
  </style>
</head>

<body class="bg-light">

  <div class="container vh-100 d-flex flex-column justify-content-start align-items-center position-relative pt-5">

    <!-- Top Thank You Message -->
    <div id="topMessage" class="alert alert-success w-100 text-center d-none" role="alert">
      ðŸŽ‰ Thank you! You are registered. Updates coming soonâ€¦
    </div>

    <!-- Title Section -->
    <div class="text-center mb-4 title-section">
      <h1>Code Master</h1>
      <h6>Powered by cdavin</h6>
    </div>

    <!-- Welcome Card -->
    <div id="welcomeCard" class="card shadow-lg p-4 fade-card visible" style="max-width: 650px; width: 100%;">
      <h4 class="mb-3 text-primary fw-bold">Welcome to Code Master</h4>
      <p>ðŸ“… Monday â†’ Topic Announced | Sunday â†’ Mock Test</p>
      <p>Registration is compulsory. Fee: <b>â‚¹199</b></p>

      <div class="mt-3 p-3 bg-light rounded">
        <h6 class="fw-bold mb-2">ðŸ”’ Mock Test Rules</h6>
        <ul class="mb-0" style="padding-left: 1.2rem;">
          <li>Camera & microphone must be enabled during the test.</li>
          <li>No screenshots allowed.</li>
          <li>No switching tabs or using other apps during the exam.</li>
          <li>Test window must remain active until submission.</li>
        </ul>
      </div>

      <button id="registerBtn" class="btn btn-primary mt-3 w-100" onclick="showRegister()">Register Now</button>
    </div>

    <!-- Register Card -->
    <div id="registerCard" class="card shadow-lg p-4 fade-card hidden" style="max-width: 500px; width: 100%;">
      <form id="cmForm">
        <div class="mb-3">
          <label class="form-label">Name</label>
          <input id="name" type="text" class="form-control" placeholder="Enter your name" required>
        </div>
        <div class="mb-3">
          <label class="form-label">Mobile Number</label>
          <input id="mobile" type="tel" class="form-control" placeholder="10-digit mobile number" required>
        </div>
        <div class="mb-3">
          <label class="form-label">Email</label>
          <input id="email" type="email" class="form-control" placeholder="Enter your email" required>
        </div>
        <div class="mb-3">
          <label class="form-label">College</label>
          <input id="college" type="text" class="form-control" placeholder="Enter your college name" required>
        </div>
        <div class="mb-3">
          <label class="form-label">Year</label>
          <select id="year" class="form-select" required>
            <option value="">Select Year</option>
            <option value="1 Year">1 Year</option>
            <option value="2 Year">2 Year</option>
            <option value="3 Year">3 Year</option>
            <option value="4 Year">4 Year</option>
          </select>
        </div>
        <div class="mb-3">
          <label class="form-label">SUC Code</label>
          <input id="succode" type="text" class="form-control" placeholder="Enter SUC code" required>
        </div>
        <button id="submitBtn" type="submit" class="btn btn-primary w-100">Proceed</button>
        <button type="button" class="btn btn-secondary w-100 mt-2" onclick="showWelcome()">Back</button>
      </form>
    </div>

    <!-- Payment Section -->
    <div id="paymentCard" class="card shadow-lg p-4 fade-card hidden" style="max-width: 500px; width: 100%;">
      <h5 class="text-success mb-3 text-center">Payment</h5>
      <p class="text-success">â‚¹199
        <!-- <span class="fw-bold text-success" id="paymentOfferPrice">Now only â‚¹49!</span> -->
      </p>
      <p>Scan QR below to pay:</p>
      <div id="qrSection" class="d-flex justify-content-center mb-3">
        <img src="phnpay.jpg" alt="Universal QR" class="img-fluid rounded shadow-sm p-3 bg-white"
          style="max-width:300px;">
      </div>
      <div class="mb-3">
        <label class="form-label">Payment Method</label>
        <select class="form-select" id="paymentMethod" required>
          <option value="">Select Payment Method</option>
          <option value="PhonePe">PhonePe</option>
          <option value="Google Pay">Google Pay</option>
          <option value="Paytm">Paytm</option>
          <option value="Amazon Pay">Amazon Pay</option>
        </select>
      </div>
      <div class="mb-3">
        <label class="form-label">Transaction ID</label>
        <input type="text" class="form-control" id="transactionId" placeholder="Enter transaction ID" required>
      </div>
      <button class="btn btn-primary w-100" onclick="submitPayment()">Submit Payment</button>
    </div>

  </div>

  <!-- Toast -->
  <div class="toast-container">
    <div id="successToast" class="toast align-items-center text-bg-success border-0" role="alert" aria-live="assertive"
      aria-atomic="true">
      <div class="d-flex">
        <div class="toast-body">âœ… Payment Completed Successfully!</div>
        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"
          aria-label="Close"></button>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener('contextmenu', e => e.preventDefault());
    document.addEventListener('keydown', e => {
      if (e.key === 'F12' || (e.ctrlKey && e.key === 'u') || (e.ctrlKey && e.shiftKey && ['I', 'J', 'C'].includes(e.key))) e.preventDefault();
    });

    function showRegister() { document.getElementById('welcomeCard').classList.replace('visible', 'hidden'); document.getElementById('registerCard').classList.replace('hidden', 'visible'); }
    function showWelcome() { document.getElementById('registerCard').classList.replace('visible', 'hidden'); document.getElementById('welcomeCard').classList.replace('hidden', 'visible'); }
    function showPayment() { document.getElementById('registerCard').classList.replace('visible', 'hidden'); document.getElementById('paymentCard').classList.replace('hidden', 'visible'); }

    const GF_CONFIG = {
      action: "https://docs.google.com/forms/d/e/YOUR_FORM_ID/formResponse",
      fields: {
        name: "entry.1111111111",
        mobile: "entry.2222222222",
        email: "entry.3333333333",
        college: "entry.4444444444",
        year: "entry.8888888888",
        succode: "entry.7777777777",
        paymentMethod: "entry.5555555555",
        transactionId: "entry.6666666666"
      }
    };

    document.getElementById('cmForm').addEventListener('submit', async e => {
      e.preventDefault();
      const name = document.getElementById('name').value.trim();
      const mobile = document.getElementById('mobile').value.trim();
      const email = document.getElementById('email').value.trim();
      const college = document.getElementById('college').value.trim();
      const year = document.getElementById('year').value.trim();
      const succode = document.getElementById('succode').value.trim();

      if (!name || !mobile || !email || !college || !year || !succode) { alert("Fill all fields"); return; }
      if (!/^\d{10}$/.test(mobile)) { alert("Enter valid 10-digit mobile number"); return; }

      localStorage.setItem('name', name);
      localStorage.setItem('mobile', mobile);
      localStorage.setItem('email', email);
      localStorage.setItem('college', college);
      localStorage.setItem('year', year);
      localStorage.setItem('succode', succode);

      try {
        const resp = await fetch("access.txt?nocache=" + new Date().getTime(), { cache: "no-store" });
        const text = await resp.text();
        const lines = text.split(/\r?\n/).map(l => l.trim().toLowerCase()).filter(l => l);

        if (lines.includes(email.toLowerCase())) {
          window.location.href = "question.html";
          return;
        }
      } catch (err) {
        console.warn("access.txt not found or fetch failed", err);
      }

      showPayment();
    });

    function submitPayment() {
      const paymentMethod = document.getElementById('paymentMethod').value;
      const transactionId = document.getElementById('transactionId').value.trim();
      if (!paymentMethod || !transactionId) { alert("Fill all fields"); return; }

      localStorage.setItem("paymentSubmitted", "true");

      const fd = new FormData();
      fd.append(GF_CONFIG.fields.name, localStorage.getItem('name'));
      fd.append(GF_CONFIG.fields.mobile, localStorage.getItem('mobile'));
      fd.append(GF_CONFIG.fields.email, localStorage.getItem('email'));
      fd.append(GF_CONFIG.fields.college, localStorage.getItem('college'));
      fd.append(GF_CONFIG.fields.year, localStorage.getItem('year'));
      fd.append(GF_CONFIG.fields.succode, localStorage.getItem('succode'));
      fd.append(GF_CONFIG.fields.paymentMethod, paymentMethod);
      fd.append(GF_CONFIG.fields.transactionId, transactionId);

      fetch(GF_CONFIG.action, { method: "POST", mode: "no-cors", body: fd })
        .finally(() => {
          document.getElementById('paymentCard').classList.replace('visible', 'hidden');
          document.getElementById('welcomeCard').classList.replace('hidden', 'visible');
          document.getElementById('topMessage').classList.remove('d-none');
          document.getElementById('registerBtn').disabled = true;
          new bootstrap.Toast(document.getElementById('successToast')).show();
        });
    }

    document.addEventListener('DOMContentLoaded', async () => {
      const email = localStorage.getItem("email");
      if (email) {
        try {
          const resp = await fetch("access.txt?nocache=" + new Date().getTime(), { cache: "no-store" });
          const text = await resp.text();
          const lines = text.split(/\r?\n/).map(l => l.trim().toLowerCase()).filter(l => l);

          if (lines.includes(email.toLowerCase())) {
            window.location.href = "question.html";
            return;
          }
        } catch (err) {
          console.warn("access.txt not found or fetch failed", err);
        }
      }

      if (localStorage.getItem("paymentSubmitted") === "true") {
        document.getElementById('topMessage').classList.remove('d-none');
        document.getElementById('registerBtn').disabled = true;
      } else if (localStorage.getItem('name')) {
        showPayment();
      }
    });
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>
